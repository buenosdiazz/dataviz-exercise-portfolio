<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Exercise Portfolio</title>
  <link href="css/style.css" rel="stylesheet" />
</head>

<body>

  <header>
    <!-- ADD YOUR NAME -->
    <h1>Carolina Diaz: Exercise Portfolio</h1>
  </header>

  <div id="content">

    <nav>
      <ul>
        <li><a href="index.html">Return to Main Page</a></li>
      </ul>
    </nav>

    <main>

      <h2>
        Stock Price History

      </h2>

      <p>Monthly stock information for Disney from May 1, 1997 to March 1, 2019</p>

      <!-- ADD YOUR VISUALIZATION HERE -->

    </main>
  </div>

  <script src="js/d3.min.js"></script>
  <script>
    d3.csv("data/DIS.csv").then(function(data) {
      console.log(data);
      //variables for height, width, and padding


      var w = 600;
      var h = 400;
      var p = 60;



      //create svg
      var svg = d3.select("main")
        .append("svg")
        .attr("width", w + p)
        .attr("height", h + p);

      // convert to date obejct
      var timeParser = d3.timeParse("%Y-%m-%d");
      data.forEach(function(d) {
        d.Date = timeParser(d.Date);

        d.Close = +d.Close;
        d.High = d.High;
        d.Low = d.Low;
        //console.log(d.Close);
      });

      //x axis

      xScale = d3.scaleTime()
        .domain([d3.min(data, function(d) {
          return d.Date;
        }), d3.max(data, function(d) {
          return d.Date
        })])
        .range([p, w - p]);

      var xAxis = d3.axisBottom()
        .scale(xScale);
      svg.append("g")
        .attr("class", "x-axis")
        .attr("transform", "translate(0," + (h - p) + ")")
        .call(xAxis);

      //y axis

      yScale = d3.scaleLinear()
        .domain([d3.min(data, function(d) {
          return d.Close;
        }), d3.max(data, function(d) {
          return d.Close
        })])
        .range([h - p, p]);

      var yAxis = d3.axisLeft()
        .scale(yScale);
      svg.append("g")
        .attr("class", "y-axis")
        .attr("transform", "translate(" + p + ",0)")
        .call(yAxis);

      //draw line
      var line = d3.line()
        .x(function(d) {
          return xScale(d.Date);
        })
        .y(function(d) {
          return yScale(d.Close);
        });


// tooltip setup
        var tooltip = d3.select("main")
          .append("div")
          .style("background", "white")
          .style("padding", "5px")
          .style("position", "absolute")
          .style("font-size", "11px")
          .style("visibility", "hidden");


      // append line
      svg.append("path")
        .datum(data)
        .attr("class", "line2")
        .attr("d", line)
        .on("mouseover", function(d){

//console.log(d[0].Date);
          return tooltip.style("visibility", "visible") .text(data, function(d) {
             return d.Close;
           });
        })
       .on("mousemove", function(d){
       return tooltip.style("top", (d3.event.pageY-10)+"px").style("left",(d3.event.pageX+10)+"px") .text(data, function(d) {
          return d.Close;
        });
     })
       .on("mouseout", function(d){
       return tooltip.style("visibility", "hidden");
       });


      //lines

      svg.append("line")
        .attr("class", "midline")
        .attr("stroke", "black")
        .attr("x1", p)
        .attr("x2", w)
        .attr("y1", yScale(d3.max(data, function(d) {
          return d.Close;
        })))
        .attr("y2", yScale(d3.max(data, function(d) {
          return d.Close;
        })));


  ;


//
//         Month and Year (i.e. Jan 2019)
// High ($96.43)
// Low ($90.83)

// Adj Close: "0.036177"
// Close: 0.093503
// Date: Mon Jan 01 1962 00:00:00 GMT-0500 (Eastern Standard Time) {}
// High: "0.100360"
// Low: "0.091009"
// Open: "0.092880"
// Volume: "15652300"

});

  </script>
</body>

</html>
